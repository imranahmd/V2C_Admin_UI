<div class="row">
    <div class="card">

        <div class="tab-content mt-3" id="lineTabContent">
            <div class="tab-pane fade show active" #home id="home" role="tabpanel" aria-labelledby="home-line-tab">
                <div class="card-header row">
                    <div class="col">
                        <h4>Download Manual Refund</h4>
                    </div>
                    <!-- <div class="col text-end">
                <button class="btn btn-warning" type="button" (click)="bulkUpload()" >
                  Bulk Upload
                </button>
              </div> -->
                </div>

                <div class="card-body bg-white">
                    <form [formGroup]="refundStatusForm" (ngSubmit)="onSubmit(refundStatusForm.value)">
                        <!-- (ngSubmit)="onSubmit(transactionListFilter.value)" -->
                        <div class="row">
                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label class="form-label">Auth ID</label>
                                    <!-- (keyup.enter)="loadDatabyMid()" (click)="loadDatabyMid()
                        
                                                 (clear)="refundListFilter.get('merchantId')?.setValue('')"
        " -->
                                    <ng-select placeholder="Auth ID" id="merchantId" formControlName="merchantId"
                                        [inputAttrs]="{maxlength:'200'}">
                                        <ng-option id="selectedOption" *ngFor="let merchant of Resdata"
                                            [value]="merchant.MerchantId">
                                            {{merchant.merchant_name}} ({{merchant.MerchantId}})
                                        </ng-option>
                                    </ng-select>

                                </div>
                            </div>

                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label class="form-label">Service Provider</label>

                                    <ng-select formControlName="sId" placeholder="Service Provider" id="merchantId"
                                        [inputAttrs]="{maxlength:'50'}" (keypress)="OnlyCharacterAllowed($event)">
                                        <ng-option id="selectedOption" *ngFor="let service of serviceProvider"
                                            [value]="service.FieldValue">
                                            {{service.FieldText}}
                                        </ng-option>
                                    </ng-select>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label class="form-label">Search By <span aria-hidden="true" class="symbol required"
                                        style="color:red;">*</span></label>

                                    <ng-select placeholder=" Select Search By" id="serchBy"
                                        formControlName="SearchBy" [items]="Search_By" bindLabel="FieldText"
                                        bindValue="FieldValue" [inputAttrs]="{maxlength:'50'}"
                                        (keypress)="OnlyCharacterAllowed($event)"
                                        [ngClass]="{'is-invalid': submit1 && refundStatusForm.get('SearchBy')?.errors}">

                                    </ng-select>

                                    <div *ngIf="submit1 && refundStatusForm.get('SearchBy')?.errors?.required"
                                    class="invalid-feedback">
                                    Please Select Search By
                                </div>

                                </div>
                            </div>




                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label class="form-label">From Date <span aria-hidden="true" class="symbol required"
                                            style="color:red;">*</span></label>
                                    <input class="form-control" id="searchFromDate" type="date" class="form-control"
                                        formControlName="FromDate" placeholder="From Date"
                                        [ngClass]="{'is-invalid': submit1 && refundStatusForm.get('FromDate')?.errors}"
                                        min="{{pastDate|date:'yyyy-MM-dd'}}" [max]="getToday()" />


                                    <div *ngIf="submit1 && refundStatusForm.get('FromDate')?.errors?.required"
                                        class="invalid-feedback">
                                        Please Select Valid From Date
                                    </div>
                                </div>


                            </div>

                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label class="form-label">To Date <span aria-hidden="true" class="symbol required"
                                            style="color:red;">*</span></label>
                                    <input class="form-control" id="searchToDate" type="date" class="form-control"
                                        formControlName="ToDate" placeholder="To Date"
                                        [ngClass]="{'is-invalid': submit1 && refundStatusForm.get('ToDate')?.errors}"
                                        min="{{pastDate|date:'yyyy-MM-dd'}}" [max]="getToday()" />

                                    <div *ngIf="submit1 && refundStatusForm.get('ToDate')?.errors?.required"
                                        class="invalid-feedback">
                                        Please Select Valid TO Date
                                    </div>
                                </div>


                            </div>



                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label class="form-label">Agg Transaction ID</label>
                                    <input class="form-control" formControlName="transactionId"
                                        placeholder="Agg Transaction ID" type="text" autocomplete="new-password"
                                        id="bankId" maxlength="40" (keypress)="OnlyNumbersAllowed($event)">

                                </div>
                            </div>

                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label class="form-label">Merchant Transaction ID</label>
                                    <input class="form-control" formControlName="merchantTransactionId"
                                        placeholder="Merchant Transaction ID" type="text" autocomplete="new-password"
                                        id="bankId" maxlength="40">

                                </div>
                            </div>

                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label class="form-label">Email ID</label>
                                    <input autocomplete="new-password" class="form-control" formControlName="custMail"
                                        id="custMail" placeholder="Email ID" type="text"
                                        [ngClass]="{'is-invalid': submit1 && refundStatusForm.get('custMail')?.errors}">

                                    <div *ngIf="submit1 && refundStatusForm.get('custMail')?.errors?.pattern"
                                        class="invalid-feedback">
                                        Please Enter Valid Email Id
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label class="form-label">Mobile Number</label>
                                    <input autocomplete="new-password" class="form-control" formControlName="custMobile"
                                        id="custMobile" placeholder="Mobile Number" type="text" maxlength="10"
                                        [ngClass]="{'is-invalid': submit1 && refundStatusForm.get('custMobile')?.errors}"
                                        (keypress)="OnlyNumbersAllowed($event)">
                                    <div *ngIf="submit1 && refundStatusForm.get('custMobile')?.errors?.pattern"
                                        class="invalid-feedback">
                                        Please Enter Valid Contact Number

                                    </div>

                                </div>
                            </div>


                            <div class="col-sm-4">
                                <div class="mb-3">
                                    <label class="form-label">Refund Type</label>
                                    <!-- (keyup.enter)="loadDatabyMid()" (click)="loadDatabyMid()
                                        
                                                                 (clear)="refundListFilter.get('merchantId')?.setValue('')"
                        " -->
                                    <ng-select placeholder="Select Refund Type" id="merchantId"
                                        formControlName="refundType" [inputAttrs]="{maxlength:'50'}"
                                        (keypress)="OnlyCharacterAllowed($event)">
                                        <ng-option id="selectedOption" *ngFor="let refundtype of refundTypeData"
                                            [value]="refundtype.FieldValue">
                                            {{refundtype.FieldText}}
                                        </ng-option>
                                    </ng-select>
                                    <!-- (keypress)="OnlyCharacterNumberAllowed($event)" -->
                                    <!-- [ngClass]="{'is-invalid': isForm1Submitted && refundListFilter.get('merchantId')?.errors}" -->

                                </div>
                            </div>




                        </div>

                        <!-- <div class="row mb-2"> 
                  <div class="col-xs-12">
                  <div class="text-end">
                    <button class="btn btn-primary pull-right" [disabled]="this.loading"  type="submit">
                      <span  id="loading" role="status" aria-hidden="true"></span>
                      Search
                    </button>
                  </div>
                </div>
               
             
              </div> -->

                        <div class="row">
                            <div class="col-md-8"></div>
                            <div class="col-md-2">
                                <button type="button" class="form-control btn btn-danger pull-right"
                                    (click)="resetform()">Reset
                                </button>
                            </div>
                            <div class="col-md-2">
                                <!-- *ngIf="fieldData && !permissions.includes('RISK_APPROVE')" -->
                                <button class="form-control btn btn-primary pull-right" type="submit"
                                    [disabled]="this.loading">
                                    <span id="loading" role="status" aria-hidden="true"></span>
                                    Search
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

        </div>




        <!-- <button (click)="dataSubmit(allBooksFormGroup.value)">
    submit data</button> -->
    </div>
</div>

<div *ngIf="this.refundStatusdata">
    <div class="row mb-md-2 mt-2">
        <div class="col-xl-10 main-content">
            <!-- <button (click)="onExportCSV()" class="btn btn-light" type="button">Export CSV<i
                    class="feather icon-download"></i>
            </button> -->
            <div class="btn-group" ngbDropdown role="group">
                <button class="btn btn-primary" ngbDropdownToggle>Columns</button>
                <div ngbDropdownMenu class="ng-dropdown-panel-items p-1"
                    style="height: 250px;width: 250px; overflow: scroll; scroll-behavior: smooth">
                    <div class="form-group">
                        <!--            <label for="columns" class="form-label"> All Columns</label>-->
                        <div *ngIf="columnDefs" class="list-group ng-option">
                            <span *ngFor="let column of columnDefs; let i = index" class="checkbox">
                                <label class="list-group-item p-2">
                                    <input class="form-check-input me-1" type="checkbox" value="{{i}}"
                                        name="{{column.headerName}}" (change)="updateSelectedTimeslots($event)"
                                        [checked]="(tableSelectedColumn && (-1 !==tableSelectedColumn.indexOf(column)) ? 'checked': '')"
                                        [disabled]="column.headerName =='Select'">
                                    {{column?.field?.replace('_', ' ')?.replace('_', ' ')?.replace('_', ' ') | uppercase
                                    }}
                                </label>
                            </span>
                        </div>

                    </div>
                    <!--          <ng-select-->
                    <!--            [(ngModel)]="tableSelectedColumn"-->
                    <!--            [closeOnSelect]="false"-->
                    <!--            [items]="columnDefs"-->
                    <!--            [multiple]=true-->
                    <!--            bindLabel="field">-->
                    <!--            <ng-template let-index="index" let-item="item" let-item$="item$" ng-option-tmp>-->
                    <!--              <input [ngModel]="item$.selected" id="item-{{index}}" type="checkbox"/> {{item.field.toUpperCase()}}-->
                    <!--            </ng-template>-->
                    <!--          </ng-select>-->

                </div>
            </div>
            <!--
                <div class="btn-group mb-1 mb-md-0">
                  <button class="btn btn-primary" type="button">Columns</button>
                  <div class="btn-group" ngbDropdown role="group">
                    <button class="btn btn-primary dropdown-toggle-split" ngbDropdownToggle></button>
                    <div ngbDropdownMenu>
                      <ng-select [(ngModel)]="tableSelectedColumn" [closeOnSelect]="false" [items]="columnDefs" [multiple]=true
                                 bindLabel="field">
                        <ng-template let-index="index" let-item="item" let-item$="item$" ng-option-tmp>
                          <input [ngModel]="item$.selected" id="item-{{index}}" type="checkbox"/> {{item.field.toUpperCase()}}
                        </ng-template>
                      </ng-select>
                    </div>
                  </div>
                </div> -->


        </div>

    </div>


    <div class="row" style="min-height:500px">
        <div class="col-12 col-xl-12 stretch-card ag-theme-alpine">
            <!-- <ag-grid-angular [enableCellTextSelection]=true (gridReady)="onGridReady($event)" [columnDefs]="columnDefs"
                [defaultColDef]="defaultColDef" class="ag-theme-alpine" [rowData]="rowData"
                (firstDataRendered)="dataRendered($event)" [paginationPageSize]="pageSize" [pagination]="true"
                [rowSelection]="'single'" [suppressPaginationPanel]="true" style="width: 100%; height: auto;">
            </ag-grid-angular> -->

            <ag-grid-angular [enableCellTextSelection]=true [columnDefs]="columnDefs" [defaultColDef]="defaultColDef"
                class="ag-theme-alpine" [rowData]="rowData" (gridReady)="onGridReady($event)"
                (firstDataRendered)="dataRendered($event)" [paginationPageSize]="pageSize" [pagination]="true"
                [suppressPaginationPanel]="true" style="width: 100%; height: auto;" [rowSelection]="rowSelection"
                (selectionChanged)="onSelectionChanged($event)">
            </ag-grid-angular>
        </div>
    </div>
    <div class="row bg-white p-2 mt-0">
        <div class="col-md-4">
            <select (change)="onPageSizeChanges($event)" [(ngModel)]="pageSize"
                class="form-select d-flex justify-content-end col-4" name="pageSize" style="width: auto">
                <option [ngValue]="10">10</option>
                <option [ngValue]="20">20</option>
                <option [ngValue]="30">30</option>
            </select>
        </div>

        <div class="col-md-8">
            <ngb-pagination (pageChange)="onPaginationChange($event)" [(page)]="currentPage" [boundaryLinks]="true"
                [collectionSize]="collectionSize" [maxSize]="5" [pageSize]="pageSize" [rotate]="true"
                class="d-flex justify-content-end align-right">
            </ngb-pagination>
        </div>

    </div>

    <div class="row mb-2">
        <div class="col-xs-12">
            <div class="text-end">
                <button class="btn btn-primary pull-right" type="button" (click)="downLoadFile()">
                    <span id="loading" role="status" aria-hidden="true"></span>
                    Submit
                </button>
            </div>
        </div>
    </div>
</div>